<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é³é­Ÿé²¼åˆ†è¾¨å¤§æŒ‘æˆ˜ - SVGç”Ÿæˆç‰ˆ</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        @keyframes float {
            0% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-15px) rotate(1deg); }
            100% { transform: translateY(0px) rotate(0deg); }
        }
        @keyframes bounce-custom {
            0%, 100% { transform: translateY(-25%) scale(1.1); animation-timing-function: cubic-bezier(0.8,0,1,1); }
            50% { transform: translateY(0) scale(1.1); animation-timing-function: cubic-bezier(0,0,0.2,1); }
        }
    </style>
</head>
<body class="bg-sky-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback, useMemo } = React;

        // --- 0. å›¾æ ‡ç»„ä»¶ (æ›¿ä»£ lucide-react ä»¥å‡å°‘ä¾èµ–) ---
        
        const IconCheck = ({ className, size = 24 }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="20 6 9 17 4 12"></polyline></svg>
        );

        const IconX = ({ className, size = 24 }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
        );

        const IconFlame = ({ className, size = 24 }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.1.2-2.2.5-3.3a9 9 0 0 0 2.5 2.8z"></path></svg>
        );

        const IconRotateCcw = ({ className, size = 24 }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg>
        );

        // --- 1. æ•°æ® ---

        const SPECIES_DATA = {
            skate: {
                id: 'skate',
                name: 'é³ (Skate)',
                simpleName: 'é³',
                desc: 'ç‰¹å¾ï¼šèº«ä½“é€šå¸¸å‘ˆè±å½¢æˆ–å¿ƒå½¢ã€‚å°¾å·´è¾ƒç²—ä¸”æœ‰è‚‰æ„Ÿï¼Œæ— æ¯’åˆºã€‚æœ€å…³é”®çš„æ˜¯å°¾å·´å°–ç«¯é™„è¿‘é€šå¸¸æœ‰ä¸¤ä¸ªå°èƒŒé³ã€‚',
                colorBase: { h: 30, s: 40, l: 60 }, // Brown/Sandish
            },
            stingray: {
                id: 'stingray',
                name: 'é­Ÿ (Stingray)',
                simpleName: 'é­Ÿ',
                desc: 'ç‰¹å¾ï¼šèº«ä½“å‘ˆåœ†å½¢æˆ–åœ†æ¶¦çš„è±å½¢ã€‚å°¾å·´åƒé­å­ä¸€æ ·ç»†é•¿ï¼Œé€šå¸¸æœ‰ä¸€æ ¹æ¯’åˆºã€‚æ²¡æœ‰èƒŒé³ã€‚',
                colorBase: { h: 200, s: 20, l: 50 }, // Greyish/Blue
            },
            eagleray: {
                id: 'eagleray',
                name: 'é²¼ (Eagle Ray/Manta)',
                simpleName: 'é²¼',
                desc: 'ç‰¹å¾ï¼šå¤´å’Œèº«ä½“åˆ†ç•Œæ˜æ˜¾ï¼ˆæœ‰å¤´é³ï¼‰ã€‚èƒ¸é³åƒå·¨å¤§çš„ç¿…è†€ã€‚é€šå¸¸åœ¨æ°´ä¸­â€œé£è¡Œâ€è€Œä¸æ˜¯è¶´åœ¨æµ·åº•ã€‚',
                colorBase: { h: 220, s: 60, l: 30 }, // Deep Blue/Black
            }
        };

        // --- 2. ç”Ÿæˆå¼è‰ºæœ¯ç»„ä»¶ ---

        const GenerativeRay = ({ type, seed }) => {
            const traits = useMemo(() => {
                const random = (offset = 0) => {
                    const x = Math.sin(seed + offset) * 10000;
                    return x - Math.floor(x);
                };

                const range = (min, max, offset) => min + random(offset) * (max - min);

                // å˜æ¢å‚æ•°
                const rotation = range(-15, 15, 1);
                const scaleX = range(0.9, 1.1, 2);
                const scaleY = range(0.9, 1.1, 3);
                
                // é¢œè‰²å˜å¼‚
                const baseColor = SPECIES_DATA[type].colorBase;
                const hue = baseColor.h + range(-10, 10, 4);
                const sat = baseColor.s + range(-10, 10, 5);
                const light = baseColor.l + range(-10, 10, 6);
                const fillColor = `hsl(${hue}, ${sat}%, ${light}%)`;
                
                // æ–‘ç‚¹ç”Ÿæˆ
                const spots = [];
                const numSpots = Math.floor(range(0, 8, 7));
                for(let i=0; i<numSpots; i++) {
                    spots.push({
                        x: range(-30, 30, i * 10),
                        y: range(-20, 20, i * 20),
                        r: range(1, 4, i * 30),
                        opacity: range(0.2, 0.5, i * 40)
                    });
                }

                const tailCurve = range(-20, 20, 8);

                return { rotation, scaleX, scaleY, fillColor, spots, tailCurve };
            }, [type, seed]);

            const renderBody = () => {
                if (type === 'skate') {
                    // é³: è±å½¢ï¼Œèƒ–å°¾å·´ï¼ŒåŒå°èƒŒé³
                    return (
                        <g transform={`scale(${traits.scaleX}, ${traits.scaleY})`}>
                            <path d="M0,-50 C30,-50 60,-20 50,10 C45,30 20,40 10,45 L5,90 L-5,90 L-10,45 C-20,40 -45,30 -50,10 C-60,-20 -30,-50 0,-50 Z" 
                                  fill={traits.fillColor} stroke="rgba(0,0,0,0.2)" strokeWidth="2" />
                            <ellipse cx="0" cy="75" rx="3" ry="6" fill={traits.fillColor} stroke="rgba(0,0,0,0.1)" />
                            <ellipse cx="0" cy="85" rx="2.5" ry="5" fill={traits.fillColor} stroke="rgba(0,0,0,0.1)" />
                        </g>
                    );
                } 
                
                if (type === 'stingray') {
                    // é­Ÿ: åœ†ç›˜ï¼Œé­å°¾ï¼Œæœ‰æ¯’åˆº
                    return (
                        <g transform={`scale(${traits.scaleX}, ${traits.scaleY})`}>
                            <path d="M0,-45 C35,-45 55,-10 45,20 C35,40 10,45 2,48" 
                                  fill={traits.fillColor} stroke="rgba(0,0,0,0.2)" strokeWidth="2" />
                            <path d="M0,-45 C-35,-45 -55,-10 -45,20 C-35,40 -10,45 -2,48" 
                                  fill={traits.fillColor} stroke="rgba(0,0,0,0.2)" strokeWidth="2" />
                            <path d={`M0,40 Q${traits.tailCurve},70 0,110`} 
                                  fill="none" stroke={traits.fillColor} strokeWidth="4" strokeLinecap="round" />
                            <path d="M0,55 L4,70 L-2,60 Z" fill="rgba(0,0,0,0.4)" />
                        </g>
                    );
                }

                if (type === 'eagleray') {
                    // é²¼: ç¿…è†€ï¼Œå¤´é³
                    return (
                        <g transform={`scale(${traits.scaleX}, ${traits.scaleY})`}>
                            <path d="M0,-20 C20,-20 80,-30 90,10 C95,30 60,40 30,35 L10,45 L-10,45 L-30,35 C-60,40 -95,30 -90,10 C-80,-30 -20,-20 0,-20 Z" 
                                  fill={traits.fillColor} stroke="rgba(0,0,0,0.2)" strokeWidth="2"/>
                            <path d="M-15,-20 L-20,-35 C-15,-40 -5,-40 0,-35 C5,-40 15,-40 20,-35 L15,-20 Z" 
                                  fill={traits.fillColor} />
                            <path d={`M0,45 Q${traits.tailCurve},80 0,120`} 
                                  fill="none" stroke={traits.fillColor} strokeWidth="2" />
                        </g>
                    );
                }
            };

            return (
                <svg viewBox="-100 -60 200 200" className="w-full h-full drop-shadow-xl filter" style={{overflow: 'visible'}}>
                    <g transform={`rotate(${traits.rotation})`}>
                        <g transform="translate(10, 10) scale(0.95)" opacity="0.2">
                             {renderBody()}
                        </g>
                        {renderBody()}
                        {traits.spots.map((spot, i) => (
                            <circle key={i} cx={spot.x} cy={spot.y} r={spot.r} fill="rgba(255,255,255,0.3)" opacity={spot.opacity} />
                        ))}
                    </g>
                </svg>
            );
        };

        // --- 3. æ¸¸æˆé€»è¾‘ç»„ä»¶ ---

        const ZhengBangModal = ({ show }) => {
            if (!show) return null;
            return (
                <div className="fixed inset-0 flex items-center justify-center z-50 pointer-events-none">
                    <div className="bg-white border-b-8 border-yellow-400 rounded-3xl p-8 shadow-2xl transform flex flex-col items-center z-50" style={{animation: 'bounce-custom 1s infinite'}}>
                        <div className="text-7xl mb-4 animate-pulse">ğŸŒŸ</div>
                        <div className="text-4xl font-black text-yellow-600 tracking-wider">è’¸ èšŒï¼</div>
                        <div className="text-lg text-gray-400 font-bold mt-2">ZHEN BANG!</div>
                    </div>
                </div>
            );
        };

        function App() {
            const [currentQuestion, setCurrentQuestion] = useState(null);
            const [selectedOption, setSelectedOption] = useState(null);
            const [gameState, setGameState] = useState('playing'); 
            const [streak, setStreak] = useState(0);
            const [showZhengBang, setShowZhengBang] = useState(false);
            const [stats, setStats] = useState({ correct: 0, total: 0 });

            const generateQuestion = useCallback(() => {
                const keys = Object.keys(SPECIES_DATA);
                const randomKey = keys[Math.floor(Math.random() * keys.length)];
                const species = SPECIES_DATA[randomKey];
                
                const seed = Math.random() * 10000;

                setCurrentQuestion({
                    correctId: species.id,
                    seed: seed,
                    correctSpecies: species
                });
                setSelectedOption(null);
                setGameState('playing');
                setShowZhengBang(false);
            }, []);

            useEffect(() => {
                generateQuestion();
            }, [generateQuestion]);

            const handleSelect = (id) => {
                if (gameState !== 'playing') return;
                
                setSelectedOption(id);
                const isCorrect = id === currentQuestion.correctId;
                
                setStats(prev => ({ correct: prev.correct + (isCorrect ? 1 : 0), total: prev.total + 1 }));

                if (isCorrect) {
                    setGameState('correct');
                    setStreak(s => s + 1);
                    setShowZhengBang(true);
                    setTimeout(() => setShowZhengBang(false), 2000);
                } else {
                    setGameState('wrong');
                    setStreak(0);
                }
            };

            const getButtonStyle = (id) => {
                const baseStyle = "w-full p-4 rounded-2xl border-2 border-b-4 font-bold text-lg transition-all active:border-b-2 active:translate-y-0.5 mb-3 flex items-center justify-between cursor-pointer";
                
                if (gameState === 'playing') {
                    return `${baseStyle} bg-white border-gray-200 text-gray-700 hover:bg-gray-50 active:bg-gray-100`;
                }
                if (id === currentQuestion.correctId) {
                    return `${baseStyle} bg-green-100 border-green-500 text-green-700`;
                }
                if (id === selectedOption && gameState === 'wrong') {
                    return `${baseStyle} bg-red-100 border-red-500 text-red-700`;
                }
                return `${baseStyle} bg-white border-gray-100 text-gray-300 opacity-60`;
            };

            if (!currentQuestion) return null;

            return (
                <div className="min-h-screen font-sans max-w-md mx-auto border-x border-gray-200 shadow-2xl flex flex-col relative overflow-hidden bg-sky-50">
                    
                    {/* Ocean Background Decor */}
                    <div className="absolute top-0 left-0 w-full h-64 bg-gradient-to-b from-sky-200 to-sky-50 -z-10 rounded-b-[3rem]"></div>

                    {/* Header */}
                    <header className="px-4 py-4 flex items-center justify-between z-10">
                        <div className="flex items-center space-x-2">
                            <span className="text-xl font-black text-sky-900 tracking-tighter">é³é­Ÿé²¼åˆ†è¾¨å™¨</span>
                        </div>
                        
                        <div className="flex items-center space-x-4">
                            {streak > 0 && (
                                <div className="flex items-center" style={{animation: 'bounce 1s infinite'}}>
                                    <IconFlame className="text-orange-500 fill-orange-500" size={20} />
                                    <span className="text-orange-600 font-black ml-1 text-lg">{streak}</span>
                                </div>
                            )}
                            <div className="flex items-center text-sky-700 font-bold bg-white/50 px-3 py-1 rounded-full backdrop-blur-sm">
                                <IconCheck className="mr-1 w-4 h-4" />
                                {stats.correct}
                            </div>
                        </div>
                    </header>

                    {/* Main Content */}
                    <main className="flex-1 p-6 flex flex-col items-center">
                        
                        <h2 className="text-lg font-bold text-sky-800 mb-2 text-center opacity-80">
                            è§‚å¯Ÿä½“å‹å’Œå°¾å·´...
                        </h2>
                        
                        <div className="w-full aspect-square bg-white/40 backdrop-blur-md rounded-[2rem] shadow-lg border-2 border-white/50 overflow-visible mb-6 relative p-8 flex items-center justify-center ring-4 ring-sky-100/50">
                            <div className="w-full h-full" style={{animation: 'float 6s ease-in-out infinite'}}>
                                <GenerativeRay 
                                    type={currentQuestion.correctId} 
                                    seed={currentQuestion.seed} 
                                />
                            </div>
                        </div>

                        {/* Options */}
                        <div className="w-full space-y-2 flex-1">
                            {Object.values(SPECIES_DATA).map((species) => (
                                <button
                                    key={species.id}
                                    onClick={() => handleSelect(species.id)}
                                    disabled={gameState !== 'playing'}
                                    className={getButtonStyle(species.id)}
                                >
                                    <span>{species.simpleName}</span>
                                    {gameState !== 'playing' && species.id === currentQuestion.correctId && <IconCheck className="text-green-600 w-6 h-6" />}
                                    {gameState !== 'playing' && species.id === selectedOption && selectedOption !== currentQuestion.correctId && <IconX className="text-red-600 w-6 h-6" />}
                                </button>
                            ))}
                        </div>
                    </main>

                    {/* Feedback Sheet */}
                    <div 
                        className={`fixed bottom-0 left-0 right-0 max-w-md mx-auto transition-transform duration-500 transform z-40 ${
                            gameState === 'playing' ? 'translate-y-[110%]' : 'translate-y-0'
                        }`}
                        style={{transitionTimingFunction: 'cubic-bezier(0.34, 1.56, 0.64, 1)'}}
                    >
                        <div className={`p-6 pb-10 rounded-t-3xl shadow-[0_-10px_40px_rgba(0,0,0,0.1)] ${
                            gameState === 'correct' 
                                ? 'bg-green-50 border-t-2 border-green-200' 
                                : 'bg-red-50 border-t-2 border-red-200'
                        }`}>
                            <div className="flex flex-col mb-4">
                                <div className="flex items-center mb-2">
                                    <div className={`font-black text-2xl mr-2 ${
                                        gameState === 'correct' ? 'text-green-600' : 'text-red-600'
                                    }`}>
                                        {gameState === 'correct' ? 'å›ç­”æ­£ç¡®ï¼' : 'å¾ˆé—æ†¾ï¼'}
                                    </div>
                                </div>
                                
                                <p className="text-gray-700 font-medium leading-relaxed bg-white/60 p-4 rounded-2xl border border-black/5 text-sm">
                                    <span className="font-bold text-gray-900 block mb-1 text-lg">{currentQuestion.correctSpecies.name}</span>
                                    {currentQuestion.correctSpecies.desc}
                                </p>
                            </div>
                            
                            <button 
                                onClick={generateQuestion}
                                className={`w-full py-4 rounded-xl font-black text-white text-lg tracking-wide shadow-lg transform transition active:scale-[0.98] flex items-center justify-center ${
                                    gameState === 'correct' 
                                    ? 'bg-green-500 hover:bg-green-600 shadow-green-200' 
                                    : 'bg-red-500 hover:bg-red-600 shadow-red-200'
                                }`}
                            >
                                ä¸‹ä¸€é¢˜ <IconRotateCcw className="ml-2 w-5 h-5" />
                            </button>
                        </div>
                    </div>

                    <ZhengBangModal show={showZhengBang} />
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
